<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‡Ÿé¤Šå°ç²¾éˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&family=Varela+Round&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cute-pink': '#FF8E8E',
                        'cute-orange': '#FFB067',
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Varela Round', 'Noto Sans TC', sans-serif; }
        .loader-ripple { display: inline-block; position: relative; width: 80px; height: 80px; }
        .loader-ripple div { position: absolute; border: 4px solid #FF8E8E; opacity: 1; border-radius: 50%; animation: loader-ripple 1s cubic-bezier(0, 0.2, 0.8, 1) infinite; }
        .loader-ripple div:nth-child(2) { animation-delay: -0.5s; }
        @keyframes loader-ripple {
            0% { top: 36px; left: 36px; width: 0; height: 0; opacity: 0; }
            5% { top: 36px; left: 36px; width: 0; height: 0; opacity: 1; }
            100% { top: 0px; left: 0px; width: 72px; height: 72px; opacity: 0; }
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* åœ“å½¢é€²åº¦æ¢ */
        .score-circle {
            position: relative;
            width: 120px;
            height: 120px;
        }
        .score-circle svg {
            transform: rotate(-90deg);
        }
        .score-circle-bg {
            fill: none;
            stroke: #f0f0f0;
            stroke-width: 8;
        }
        .score-circle-progress {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
            animation: fillScore 1.5s ease-out forwards;
        }
        @keyframes fillScore {
            from { stroke-dashoffset: 360; }
            to { stroke-dashoffset: var(--dashoffset, 360); }
        }
        .score-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        
        /* å¡ç‰‡æ·¡å…¥å‹•ç•« */
        .fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* è©•åˆ†å¡å‹•ç•« */
        .score-card {
            transition: all 0.3s ease;
        }
        .score-card:hover {
            transform: translateY(-4px);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-50 to-pink-50 min-h-screen flex flex-col items-center justify-center p-0 md:p-6 text-slate-700">
    <div class="w-full md:max-w-xl bg-white/80 backdrop-blur-xl md:rounded-[2.5rem] shadow-[0_20px_60px_-15px_rgba(255,142,142,0.3)] min-h-screen md:min-h-0 md:h-[90vh] border-4 border-white overflow-hidden relative flex flex-col">
        
        <header class="bg-gradient-to-r from-cute-orange to-cute-pink p-6 text-white text-center shadow-lg shrink-0 z-20 rounded-b-[2rem]">
            <h1 class="text-3xl font-bold tracking-wider flex justify-center items-center gap-2 drop-shadow-md">
                ğŸ‘ ç‡Ÿé¤Šå°ç²¾éˆ v8.1
            </h1>
            <p class="text-xs text-white/80 mt-2">æ‹ç…§æˆåˆ†è¡¨ AI åˆ†æ</p>
        </header>

        <main class="flex-1 p-6 space-y-6 overflow-y-auto no-scrollbar relative">
            
            <div class="bg-white p-4 rounded-3xl border-2 border-orange-100 shadow-sm">
                <input type="password" id="apiKeyInput" placeholder="âœ¨ è«‹å…ˆé¤µé£Ÿ API Key æ‰èƒ½é‹ä½œå–”" 
                    class="w-full p-3 bg-orange-50/50 border-none rounded-2xl text-sm text-center placeholder-orange-300 text-orange-600 focus:ring-4 focus:ring-orange-100 outline-none">
            </div>

            <div class="space-y-4">
                <div class="border-4 border-dashed border-pink-200 bg-pink-50/30 rounded-[2rem] p-12 text-center relative cursor-pointer hover:bg-pink-50 transition-all group">
                    <input type="file" id="imageInput" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20">
                    <div class="transform group-hover:scale-110 transition-transform duration-300">
                        <div class="text-7xl mb-4">ğŸ“¸</div>
                        <h3 class="font-bold text-cute-pink text-xl">æ‹æ”é£Ÿå“èƒŒé¢</h3>
                        <p class="text-sm text-pink-300 mt-3 font-bold">æˆåˆ†è¡¨ã€ç‡Ÿé¤Šæ¨™ç¤ºéƒ½å¯ä»¥ï¼</p>
                    </div>
                </div>

                <div id="previewContainer" class="hidden relative rounded-3xl overflow-hidden shadow-lg ring-4 ring-pink-100">
                    <img id="imagePreview" class="w-full h-64 object-cover" src="" alt="">
                    <button onclick="clearImage()" class="absolute top-3 right-3 bg-white text-red-500 rounded-full p-2 hover:bg-red-50 shadow-lg font-bold text-lg">âœ•</button>
                </div>

                <button id="analyzeBtn" class="w-full bg-gradient-to-r from-cute-pink to-rose-400 text-white font-bold py-5 rounded-3xl shadow-lg shadow-pink-200 hover:shadow-xl hover:-translate-y-1 transition-all disabled:opacity-50 text-lg">
                    âœ¨ é–‹å§‹æ–½å±•é­”æ³•
                </button>
            </div>

            <div id="loadingOverlay" class="hidden absolute inset-0 bg-white/90 backdrop-blur-md z-50 flex flex-col items-center justify-center p-8 text-center rounded-[2.5rem]">
                <div class="loader-ripple"><div></div><div></div></div>
                <h3 class="text-xl font-bold text-cute-pink mt-6 mb-2">æ­£åœ¨ç”¨åŠ›çœ‹åœ–ç‰‡...</h3>
                <p id="loadingTip" class="text-orange-400 text-sm animate-pulse font-bold bg-orange-50 px-4 py-2 rounded-full">AI å°ç²¾éˆæ­£åœ¨åˆ†ææˆåˆ†è¡¨...</p>
                <button onclick="stopAnalyze()" class="mt-8 text-xs text-slate-400 underline decoration-slate-300">å–æ¶ˆåˆ†æ</button>
            </div>

            <!-- çµæœå€åŸŸ -->
            <div id="resultArea" class="hidden space-y-6 pb-20">
                <!-- è©•åˆ†å¡ -->
                <div id="verdictCard" class="score-card fade-in-up bg-gradient-to-br rounded-[2.5rem] p-8 shadow-lg text-white relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-40 h-40 opacity-10 -mr-10 -mt-10">
                        <svg viewBox="0 0 100 100" fill="currentColor">
                            <circle cx="50" cy="50" r="45"/>
                        </svg>
                    </div>
                    <div class="relative z-10">
                        <h2 id="resProductName" class="text-3xl font-bold mb-2"></h2>
                        <p id="resTitle" class="text-white/90 text-lg mb-6 font-semibold"></p>
                        
                        <div class="flex items-center gap-6 justify-between">
                            <div>
                                <div id="resHealthBadge" class="text-sm font-bold mb-3"></div>
                                <p class="text-xs text-white/70">å¥åº·è©•ç´š</p>
                            </div>
                            <div class="score-circle">
                                <svg width="120" height="120" viewBox="0 0 120 120">
                                    <circle class="score-circle-bg" cx="60" cy="60" r="50"/>
                                    <circle id="scoreProgress" class="score-circle-progress" cx="60" cy="60" r="50" style="stroke-dasharray: 314; --dashoffset: 314;"/>
                                </svg>
                                <div class="score-text">
                                    <div id="resScore" class="text-3xl font-bold">-</div>
                                    <div class="text-xs text-white/70">åˆ†</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç‡Ÿé¤Šäº®é» -->
                <div class="fade-in-up" style="animation-delay: 0.2s;">
                    <h3 class="text-lg font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <span class="text-2xl">â­</span> ç‡Ÿé¤Šäº®é»
                    </h3>
                    <div id="resHighlights" class="space-y-3"></div>
                </div>

                <!-- è¨ˆåˆ†è©³æƒ… -->
                <div class="fade-in-up bg-white rounded-[2.5rem] p-6 shadow-lg border-2 border-orange-50" style="animation-delay: 0.3s;">
                    <h3 class="text-lg font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <span class="text-2xl">ğŸ“Š</span> è©•åˆ†è©³æƒ…
                    </h3>
                    <div id="scoreBreakdown" class="space-y-3"></div>
                </div>

                <!-- æˆåˆ†è§£å¯† -->
                <div class="fade-in-up bg-white rounded-[2.5rem] p-6 shadow-lg border-2 border-orange-50" style="animation-delay: 0.4s;">
                    <h3 class="text-lg font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <span class="text-2xl">ğŸ”¬</span> æˆåˆ†è§£å¯†
                    </h3>
                    <div id="resTranslations" class="space-y-4"></div>
                </div>

                <!-- å¥åº·å»ºè­° -->
                <div class="fade-in-up bg-gradient-to-br from-orange-100 to-pink-100 rounded-[2.5rem] p-6 shadow-lg border-2 border-orange-200" style="animation-delay: 0.5s;">
                    <h3 class="text-lg font-bold text-slate-800 mb-3 flex items-center gap-2">
                        <span class="text-2xl">ğŸ’¡</span> å°ç²¾éˆçš„å»ºè­°
                    </h3>
                    <p id="resAdvice" class="text-slate-700 font-medium leading-relaxed"></p>
                </div>

                <button onclick="resetApp()" class="w-full py-4 text-slate-400 text-sm font-bold hover:text-cute-pink transition flex items-center justify-center gap-2 fade-in-up" style="animation-delay: 0.6s;">
                    <span class="text-xl">â†º</span> å†åˆ†æä¸€å¼µ
                </button>
            </div>

            <!-- éŒ¯èª¤è¨Šæ¯ -->
            <div id="msgArea" class="hidden bg-red-50 p-6 rounded-[2rem] border-2 border-red-100 text-red-500 text-sm text-center shadow-sm">
                <div class="text-5xl mb-3">ğŸ¥º</div>
                <p id="msgText" class="font-bold mb-2"></p>
                <p class="text-xs text-red-400">è«‹æª¢æŸ¥ API Key æˆ–é‡æ–°ä¸Šå‚³åœ–ç‰‡</p>
            </div>
        </main>
    </div>

    <script>
        const MODEL_NAME = "gemini-2.5-flash-lite";
        const apiKeyInput = document.getElementById('apiKeyInput');
        const imageInput = document.getElementById('imageInput');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const resultArea = document.getElementById('resultArea');
        const msgArea = document.getElementById('msgArea');
        const loadingOverlay = document.getElementById('loadingOverlay');
        
        let base64Image = null;
        let photoFileType = null;
        let isLoading = false;

        imageInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if(!file) return;
            if (file.size > 20 * 1024 * 1024) {
                alert('åœ–ç‰‡å¤ªå¤§äº†ï¼è«‹é¸æ“‡ 20MB ä»¥ä¸‹çš„åœ–ç‰‡');
                return;
            }
            photoFileType = file.type;
            const reader = new FileReader();
            reader.onload = (e) => {
                base64Image = e.target.result.split(',')[1];
                document.getElementById('imagePreview').src = e.target.result;
                document.getElementById('previewContainer').classList.remove('hidden');
                analyzeBtn.disabled = false;
            };
            reader.readAsDataURL(file);
        });

        function clearImage() {
            base64Image = null;
            imageInput.value = '';
            document.getElementById('previewContainer').classList.add('hidden');
            analyzeBtn.disabled = true;
        }

        analyzeBtn.addEventListener('click', async function() {
            if(!base64Image) { alert("è«‹å…ˆé¸ç…§ç‰‡"); return; }
            await analyzeWithAI();
        });

        async function analyzeWithAI() {
            if (isLoading) return;
            isLoading = true;
            const apiKey = apiKeyInput.value.trim();
            if (!apiKey) {
                isLoading = false;
                showError("âš ï¸ è«‹å…ˆè¼¸å…¥ API Keyï¼");
                return;
            }

            startLoading("æ­£åœ¨åˆ†æåœ–ç‰‡...");

            try {
                const promptText = `ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„é£Ÿå“ç‡Ÿé¤Šåˆ†æå¸«ï¼Œé¢¨æ ¼å¯æ„›å‹å–„ã€‚è«‹æ ¹æ“šä»¥ä¸‹å°ç£è¡›ç¦éƒ¨æ¨™æº–åˆ†æåœ–ç‰‡ä¸­çš„ç‡Ÿé¤Šæ¨™ç¤ºã€‚

ã€ç‡Ÿé¤Šè©•åˆ†æ¨™æº–ã€‘ï¼ˆæ¯é … 100ml æˆ– 100gï¼‰
ç´…ç‡ˆï¼ˆä¸åˆæ ¼ï¼‰æ¨™æº–ï¼š
- ç³–åˆ† > 12.5g â†’ é«˜ç³–
- éˆ‰ > 600mg â†’ é«˜éˆ‰
- é£½å’Œè„‚è‚ª > 5g â†’ é«˜é£½å’Œè„‚è‚ª
- åå¼è„‚è‚ª > 0.3g â†’ é«˜åå¼è„‚è‚ª
- æ·»åŠ åŠ‘è¶…é 8 ç¨® â†’ æ·»åŠ åŠ‘éå¤š

é»ƒç‡ˆï¼ˆæ³¨æ„ï¼‰æ¨™æº–ï¼š
- ç³–åˆ† 5-12.5g â†’ ä¸­ç­‰ç³–åˆ†
- éˆ‰ 200-600mg â†’ ä¸­ç­‰éˆ‰
- é£½å’Œè„‚è‚ª 1.5-5g â†’ ä¸­ç­‰é£½å’Œè„‚è‚ª

ç¶ ç‡ˆï¼ˆå¥åº·ï¼‰æ¨™æº–ï¼š
- ç³–åˆ† < 5g â†’ ä½ç³–
- éˆ‰ < 200mg â†’ ä½éˆ‰
- é£½å’Œè„‚è‚ª < 1.5g â†’ ä½é£½å’Œè„‚è‚ª
- è›‹ç™½è³ª > 5g â†’ å„ªè³ªè›‹ç™½
- çº–ç¶­ > 3g â†’ é«˜çº–

ã€è¨ˆåˆ†è¦å‰‡ã€‘
- ç´…ç‡ˆé …ç›®æ¯é … -30 åˆ†
- é»ƒç‡ˆé …ç›®æ¯é … -10 åˆ†
- ç¶ ç‡ˆé …ç›®æ¯é … +10 åˆ†
- èµ·å§‹åˆ† 100 åˆ†

æœ€çµ‚è©•åˆ†ï¼š
- >= 70 åˆ† â†’ greenï¼ˆâœ… å¥åº·å¯¶å¯¶ï¼‰
- 40-69 åˆ† â†’ yellowï¼ˆâš ï¸ æ³¨æ„ä»½é‡ï¼‰
- < 40 åˆ† â†’ redï¼ˆğŸ›‘ å°‘åƒä¸€é»ï¼‰

è«‹åˆ†æé€™å¼µåœ–ç‰‡ï¼Œå›å‚³ç´” JSONï¼ˆä¸è¦ä»»ä½•å…¶ä»–æ–‡å­—ï¼‰ï¼š

{
  "productName": "é£Ÿå“åç¨±",
  "score": 65,
  "scoreBreakdown": {
    "redItems": [{"name": "ç³–åˆ†", "value": "18g", "score": -30}],
    "yellowItems": [{"name": "éˆ‰", "value": "450mg", "score": -10}],
    "greenItems": [{"name": "è›‹ç™½è³ª", "value": "8g", "score": 10}]
  },
  "verdict": {
    "title": "ä¸€å¥å¯æ„›çŸ­è©•",
    "color": "red|yellow|green"
  },
  "highlights": [
    {
      "type": "bad|good",
      "label": "æˆåˆ†åç¨±",
      "value": "æ•¸å€¼+å–®ä½",
      "desc": "ç°¡çŸ­è§£é‡‹"
    }
  ],
  "translations": [
    {
      "origin": "åŸæ–‡",
      "simplified": "é€šä¿—èªªæ³•",
      "explain": "ç‚ºä»€éº¼å€¼å¾—æ³¨æ„"
    }
  ],
  "advice": "å¥åº·å»ºè­°"
}`;

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [
                                { text: promptText },
                                { inline_data: { mime_type: photoFileType, data: base64Image } }
                            ]
                        }]
                    })
                });

                const data = await response.json();
                if (data.error) throw new Error(data.error.message);
                if (!data.candidates?.[0]?.content?.parts?.[0]?.text) throw new Error("AI æ²’æœ‰å›æ‡‰");

                const jsonText = data.candidates[0].content.parts[0].text.replace(/```json|```/g, '').trim();
                const result = JSON.parse(jsonText);
                stopLoading();
                renderResult(result);

            } catch (error) {
                console.error(error);
                stopLoading();
                let msg = error.message;
                if(msg.includes("429")) msg = "API é¡åº¦ç”¨å®Œäº†";
                else if(msg.includes("401")) msg = "API Key ç„¡æ•ˆ";
                else if(msg.includes("not found")) msg = "æ‰¾ä¸åˆ°æ¨¡å‹";
                else if(msg.includes("JSON")) msg = "AI å›æ‡‰æ ¼å¼æœ‰èª¤ï¼Œè«‹é‡è©¦";
                showError(`åˆ†æå¤±æ•—ï¼š${msg}`);
            } finally {
                isLoading = false;
            }
        }

        function renderResult(data) {
            resultArea.classList.remove('hidden');
            msgArea.classList.add('hidden');
            
            document.getElementById('resProductName').textContent = data.productName || "é£Ÿå“";
            document.getElementById('resTitle').textContent = `ã€Œ${data.verdict.title}ã€`;
            document.getElementById('resScore').textContent = data.score || '?';
            document.getElementById('resAdvice').textContent = typeof data.advice === 'string' ? data.advice : data.advice.action || data.advice;

            const color = data.verdict.color || 'yellow';
            const colorMap = {
                'red': { bg: 'from-red-400 to-rose-400', badge: 'ğŸ›‘ å°‘åƒä¸€é»', progress: '#EF4444' },
                'yellow': { bg: 'from-yellow-400 to-orange-400', badge: 'âš ï¸ æ³¨æ„ä»½é‡', progress: '#FBBF24' },
                'green': { bg: 'from-emerald-400 to-teal-400', badge: 'âœ… å¥åº·å¯¶å¯¶', progress: '#10B981' }
            };
            
            const c = colorMap[color] || colorMap['yellow'];
            document.getElementById('verdictCard').className = `score-card fade-in-up bg-gradient-to-br ${c.bg} rounded-[2.5rem] p-8 shadow-lg text-white relative overflow-hidden`;
            document.getElementById('resHealthBadge').textContent = c.badge;
            
            // é€²åº¦æ¢å‹•ç•«
            const score = data.score || 0;
            const progress = document.getElementById('scoreProgress');
            const circumference = 2 * Math.PI * 50;
            const offset = circumference * (1 - score / 100);
            progress.style.stroke = c.progress;
            progress.style.setProperty('--dashoffset', offset);

            // ç‡Ÿé¤Šäº®é»
            const hlContainer = document.getElementById('resHighlights');
            hlContainer.innerHTML = (data.highlights || []).map((item, idx) => `
                <div class="fade-in-up p-4 rounded-2xl border-2 transition-all hover:shadow-lg ${item.type === 'good'?'bg-emerald-50 border-emerald-200 hover:bg-emerald-100':'bg-red-50 border-red-200 hover:bg-red-100'}" style="animation-delay: ${0.1 * idx}s;">
                    <div class="flex items-start gap-3">
                        <div class="text-3xl">${item.type === 'good'?'ğŸŒŸ':'âš¡'}</div>
                        <div class="flex-1">
                            <div class="flex justify-between items-start mb-1">
                                <span class="font-bold text-slate-700">${item.label}</span>
                                <span class="text-xs font-bold px-3 py-1 rounded-full ${item.type === 'good'?'bg-emerald-200 text-emerald-700':'bg-red-200 text-red-700'}">${item.value}</span>
                            </div>
                            <p class="text-xs text-slate-600">${item.desc}</p>
                        </div>
                    </div>
                </div>`).join('');

            // è¨ˆåˆ†è©³æƒ…
            const breakdown = data.scoreBreakdown || {};
            const scoreContainer = document.getElementById('scoreBreakdown');
            scoreContainer.innerHTML = '';
            
            if (breakdown.redItems?.length) {
                breakdown.redItems.forEach(item => {
                    scoreContainer.innerHTML += `
                        <div class="flex items-center justify-between p-4 bg-red-50 rounded-2xl border-2 border-red-200 hover:shadow-lg transition-all">
                            <div>
                                <div class="font-bold text-red-700">${item.name}</div>
                                <div class="text-xs text-red-600">ä¸åˆæ ¼</div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-red-600 text-lg">${item.value}</div>
                                <div class="text-xs font-bold text-red-600">${item.score} åˆ†</div>
                            </div>
                        </div>`;
                });
            }
            
            if (breakdown.yellowItems?.length) {
                breakdown.yellowItems.forEach(item => {
                    scoreContainer.innerHTML += `
                        <div class="flex items-center justify-between p-4 bg-yellow-50 rounded-2xl border-2 border-yellow-200 hover:shadow-lg transition-all">
                            <div>
                                <div class="font-bold text-yellow-700">${item.name}</div>
                                <div class="text-xs text-yellow-600">éœ€æ³¨æ„</div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-yellow-600 text-lg">${item.value}</div>
                                <div class="text-xs font-bold text-yellow-600">${item.score} åˆ†</div>
                            </div>
                        </div>`;
                });
            }
            
            if (breakdown.greenItems?.length) {
                breakdown.greenItems.forEach(item => {
                    scoreContainer.innerHTML += `
                        <div class="flex items-center justify-between p-4 bg-emerald-50 rounded-2xl border-2 border-emerald-200 hover:shadow-lg transition-all">
                            <div>
                                <div class="font-bold text-emerald-700">${item.name}</div>
                                <div class="text-xs text-emerald-600">å„ªè³ª</div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-emerald-600 text-lg">${item.value}</div>
                                <div class="text-xs font-bold text-emerald-600">+${item.score} åˆ†</div>
                            </div>
                        </div>`;
                });
            }

            // æˆåˆ†è§£å¯†
            const transContainer = document.getElementById('resTranslations');
            transContainer.innerHTML = (data.translations?.length) ? data.translations.map(t => `
                <div class="p-4 bg-gradient-to-r from-orange-50 to-pink-50 rounded-2xl border-2 border-orange-100 hover:shadow-lg transition-all">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="text-xs text-slate-400 line-through">${t.origin}</span>
                        <span class="font-bold text-cute-pink">â†’ ${t.simplified}</span>
                    </div>
                    <p class="text-sm text-slate-600 leading-relaxed">ğŸ’¡ ${t.explain}</p>
                </div>`).join('') : "<p class='text-sm text-slate-400 text-center py-4'>æˆåˆ†å¾ˆå–®ç´”ï½âœ¨</p>";
        }

        function showError(msg) {
            msgArea.classList.remove('hidden');
            document.getElementById('msgText').textContent = msg;
            resultArea.classList.add('hidden');
        }

        function resetApp() {
            resultArea.classList.add('hidden');
            msgArea.classList.add('hidden');
            clearImage();
        }

        function startLoading(msg) {
            loadingOverlay.classList.remove('hidden');
            document.getElementById('loadingTip').textContent = msg;
        }

        function stopLoading() { loadingOverlay.classList.add('hidden'); }
        function stopAnalyze() { stopLoading(); resetApp(); }
    </script>
</body>
</html>
